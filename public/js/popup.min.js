var ArrowsPopup,BasePopup,QueryPopup,extend=function(t,e){function o(){this.constructor=t}for(var n in e)hasProp.call(e,n)&&(t[n]=e[n]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;BasePopup=function(){function t(t){this.app=t,this.popup=$("<div class='popup_overlay'><div class='popup'><div class='popup_content'></div></div></div>"),this["class"]=this.constructor.name.replace(/[A-Z]/g,function(t,e,o,n,i){return e>0?"_"+t:t}).toLowerCase(),this.popup.addClass(this["class"]),this.app.root.find(".popup_overlay").filter("."+this["class"]).detach(),this.app.root.append(this.popup),this.container=this.popup.find(".popup_content"),this.container.empty(),this.setContent(),this.popup.on("click touchstart",function(t){return function(e){return 0===$(e.target).closest(".popup_content").length?(t.hide(),!1):void 0}}(this))}return t.prototype.setContent=function(){return this.container.append('<input type="submit" value="True" />'),this.container.append('<input type="submit" value="False" />')},t.prototype.show=function(){return this.popup.show()},t.prototype.hide=function(){return this.popup.hide()},t}(),QueryPopup=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return extend(e,t),e.prototype.setContent=function(){},e.prototype.show=function(t,o,n){return this.elements=null!=t?t:void 0,this.callback=null!=o?o:void 0,null==n&&(n=void 0),this.result={undefined:n},this.container.html("<ul class='query-list'></ul>"),$.each(this.elements,function(t){return function(e,o){var n;return n=o instanceof jQuery?o:$("<li></li>").append(o),t.container.append(n),n.attr("data-query-key",e),n.on("click",function(){t.result={key:e,value:o},t.hide()})}}(this)),e.__super__.show.call(this)},e.prototype.hide=function(){return $.isFunction(this.callback)&&this.callback(this.result.key,this.result.value),e.__super__.hide.call(this)},e}(BasePopup),ArrowsPopup=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return extend(e,t),e.prototype.button_size=60,e.prototype.cell=void 0,e.prototype.free=void 0,e.prototype.items=function(){return[$("<canvas/>").attr("width",this.button_size).attr("height",this.button_size),$("<canvas/>").attr("width",this.button_size).attr("height",this.button_size)]},e.prototype.renderArrows=function(t,e,o){var n,i,r,s,p,u,a,c,h,l,d,y,_;for(h=t.getContext("2d"),h.clearRect(0,0,this.button_size,this.button_size),r=s=.5*this.button_size,n=.25*this.button_size,i=n*Math.sin(Math.PI/3),h.strokeStyle="#080",h.lineWidth=2,h.beginPath(),d=l=0,y=e.length;y>l;d=++l)_=e[d],a=_.x-o.x,c=_.y-o.y,p=1.5*(a+c)*n,u=(c-a)*i,h.moveTo(r,s),h.lineTo(r+p,s+u);return h.stroke(),h.strokeStyle="#800",h.beginPath(),h.arc(r,s,5,0,7),h.closePath(),h.fill()},e.prototype.show=function(t,o,n){return this.elements=null!=t?t:void 0,this.callback=null!=o?o:void 0,null==n&&(n=void 0),e.__super__.show.call(this,this.elements,this.callback,n),null!=this.cell&&null!=this.free?this.container.find("canvas").each(function(t){return function(e,o){return t.renderArrows(o,t.free[e],t.cell)}}(this)):void 0},e}(QueryPopup),window.BasePopup=BasePopup,window.QueryPopup=QueryPopup,window.ArrowsPopup=ArrowsPopup;